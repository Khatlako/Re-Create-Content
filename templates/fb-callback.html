{% extends "base.html" %}
{% block content %}
<div class="page">
    <h1>Facebook Authorization</h1>
    <p>Processing your authorization, please wait...</p>
</div>

<script>
    // Extract "code" parameter from the URL
    const params = new URLSearchParams(window.location.search);
    const code = params.get("code");
    const error = params.get("error");

    if (code) {
        document.querySelector(".page").innerHTML = `
            <h1>Authorization Successful</h1>
            <p>Authorization code received. You can now close this page.</p>
        `;

        // Optional: Send the code to your server or Make.com webhook
        fetch("https://hook.eu2.make.com/j64u5rj9rtsuczkrllgydwvsyy8xay2h", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ code: code })
        });
    } else if (error) {
        document.querySelector(".page").innerHTML = `
            <h1>Authorization Failed</h1>
            <p>${error}</p>
        `;
    }
</script>
{% endblock %}
